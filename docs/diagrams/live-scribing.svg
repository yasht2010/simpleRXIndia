<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1100 520" width="1100" height="520" font-family="Arial, sans-serif">
  <defs>
    <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#1f2937" />
    </marker>
    <style>
      .box { fill:#f8fafc; stroke:#1f2937; stroke-width:1.4; rx:8; ry:8; }
      .label { font-size:14px; fill:#0f172a; font-weight:bold; }
      .sublabel { font-size:12px; fill:#475569; }
      .arrow { stroke:#1f2937; stroke-width:1.6; marker-end:url(#arrow); fill:none; }
      .note { font-size:12px; fill:#111827; font-weight:600; }
      .dashed { stroke-dasharray:6 4; }
    </style>
  </defs>

  <!-- Top row -->
  <rect class="box" x="70" y="70" width="170" height="70" />
  <text x="155" y="100" text-anchor="middle" class="label">Browser</text>
  <text x="155" y="120" text-anchor="middle" class="sublabel">mic + UI</text>

  <rect class="box" x="320" y="70" width="170" height="70" />
  <text x="405" y="100" text-anchor="middle" class="label">Socket.IO</text>
  <text x="405" y="120" text-anchor="middle" class="sublabel">audio channel</text>

  <rect class="box" x="570" y="70" width="190" height="70" />
  <text x="665" y="100" text-anchor="middle" class="label">Express server.js</text>
  <text x="665" y="120" text-anchor="middle" class="sublabel">socket handlers</text>

  <rect class="box" x="840" y="70" width="180" height="70" />
  <text x="930" y="100" text-anchor="middle" class="label">Deepgram</text>
  <text x="930" y="120" text-anchor="middle" class="sublabel">live transcription</text>

  <!-- Streaming path -->
  <line class="arrow" x1="240" y1="105" x2="320" y2="105" />
  <text class="note" x="280" y="95" text-anchor="middle">connect</text>

  <line class="arrow" x1="490" y1="105" x2="570" y2="105" />
  <text class="note" x="530" y="95" text-anchor="middle">session attach</text>

  <line class="arrow" x1="740" y1="105" x2="840" y2="105" />
  <text class="note" x="790" y="95" text-anchor="middle">PCM chunks</text>

  <line class="arrow" x1="840" y1="125" x2="740" y2="125" />
  <text class="note" x="790" y="145" text-anchor="middle">transcripts</text>

  <line class="arrow" x1="570" y1="125" x2="490" y2="125" />
  <text class="note" x="530" y="145" text-anchor="middle">emit transcript-update</text>

  <line class="arrow" x1="320" y1="125" x2="240" y2="125" />
  <text class="note" x="280" y="145" text-anchor="middle">UI updates</text>

  <!-- Finalize path -->
  <rect class="box" x="70" y="300" width="170" height="70" />
  <text x="155" y="330" text-anchor="middle" class="label">Browser</text>
  <text x="155" y="350" text-anchor="middle" class="sublabel">finalize-prescription</text>

  <rect class="box" x="380" y="300" width="190" height="70" />
  <text x="475" y="330" text-anchor="middle" class="label">Express server.js</text>
  <text x="475" y="350" text-anchor="middle" class="sublabel">deduct credit</text>

  <rect class="box" x="680" y="300" width="180" height="70" />
  <text x="770" y="330" text-anchor="middle" class="label">LLM</text>
  <text x="770" y="350" text-anchor="middle" class="sublabel">scribe prompt</text>

  <line class="arrow" x1="240" y1="335" x2="380" y2="335" />
  <text class="note" x="310" y="325" text-anchor="middle">socket emit</text>

  <line class="arrow" x1="570" y1="335" x2="680" y2="335" />
  <text class="note" x="625" y="325" text-anchor="middle">runLlmTask('scribe')</text>

  <line class="arrow" x1="680" y1="355" x2="570" y2="355" />
  <text class="note" x="625" y="375" text-anchor="middle">html result</text>

  <line class="arrow" x1="380" y1="355" x2="240" y2="355" />
  <text class="note" x="310" y="375" text-anchor="middle">prescription-result {html, credits}</text>

  <text class="note" x="155" y="400" text-anchor="middle">Optional: autoReview() â†’ autoFormat()</text>
</svg>
